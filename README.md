# FDMJ2025 编译器

## 项目简介
该编译器的目标是将FDMJ语言的源代码编译为RPi（ARM）汇编代码。编译器的实现涉及多个阶段，每个阶段都对应着编译过程中的一个关键步骤。从源代码的解析到最终的汇编代码生成，整个过程通过精心设计和实现，以确保编译器的正确性和高效性。

## 目录结构
```
project/
├── build/                # 构建目录，用于存放编译生成的文件
├── docs/                 # 文档目录，存放报告文件（如 report.pdf）
├── include/              # 头文件目录
├── lib/                  # 库文件目录
├── test/                 # 测试文件目录
│   └── fmj_normal/       # 存放测试文件的子目录
├── vendor/               # 第三方库目录
│   └── libsysy/          # 第三方库文件
└── tools/                # 工具目录，包含主程序 main
```

## 使用方法

### 构建项目
运行以下命令以构建项目：
```bash
make build
```
此命令会在当前目录下创建一个 `build` 文件夹，并在其中运行 CMake 和 Make 命令，生成项目所需的可执行文件。

### 清理项目
运行以下命令以清理项目：
```bash
make clean
```
此命令会删除 `build` 文件夹，并清理 `test/fmj_normal` 目录中除 `.fmj` 文件以外的所有文件。

### 重新构建项目
运行以下命令以重新构建项目：
```bash
make rebuild
```
此命令会先执行 `clean` 操作，然后重新执行 `build` 操作。

### 编译测试文件
运行以下命令以编译测试文件：
```bash
make compile
```
此命令会使用 `tools/main/main` 程序编译 `test/fmj_normal` 目录下的所有 `.fmj` 文件。

### 运行测试文件
运行以下命令以运行测试文件：
```bash
make run
```
此命令会编译并运行 `test/fmj_normal` 目录下的所有 `.fmj` 文件，并使用 `qemu-arm` 模拟器运行生成的汇编程序。

### 编译单个测试文件
运行以下命令以编译单个测试文件：
```bash
make compile-one
```
此命令会编译指定的测试文件（默认为 `hw5test0`）。可以通过修改 `FILE` 变量的值来指定其他文件。

### 运行单个测试文件
运行以下命令以运行单个测试文件：
```bash
make run-one
```
此命令会编译并运行指定的测试文件（默认为 `hw5test0`）。可以通过修改 `FILE` 变量的值来指定其他文件。

### 打包提交
运行以下命令以打包提交：
```bash
make handin
```
此命令会检查 `docs/report.pdf` 文件是否存在。如果不存在，会提示用户先生成报告。如果存在，会提示用户输入“学号-姓名”，并生成一个包含报告和项目代码的压缩文件。

## 注意事项
1. 确保系统执行环境是64位Ubuntu 20（或更高版本）Linux操作系统，x86架构。
2. 确保系统已安装以下工具：
   - CMake
   - Make
   - GCC（用于交叉编译）
   - QEMU（用于模拟 ARM 架构）
3. 修改 `FILE` 变量的值时，请确保文件名与实际测试文件一致。
4. 在运行 `make handin` 命令之前，请确保 `docs/report.pdf` 文件已生成。
